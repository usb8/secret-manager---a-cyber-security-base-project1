{% extends 'base.html' %}

{% block content %}
<h2>{{ secret.title }}</h2>
{% if secret.secret_header %}
<p>{{ secret.secret_header }}</p>
{% endif %}

{# Vulnerable version shows decrypted key #}
{% if decrypted_key %}
<div class="secret-key">
    <strong>Secret:</strong> 
    <span class="reveal" onclick="this.classList.toggle('masked')">
        <span class="masked">{{ decrypted_key|make_list|first }}•••••</span>
        <span class="unmasked">{{ decrypted_key }}</span>
    </span>
</div>
{% endif %}

{# Fixed version would have more controlled access #}
<p><small>Created at: {{ secret.created_at }}</small></p>
<a href="{% url 'secrets' %}">Back to all secrets</a>
{% endblock %}